# üîß –ò—Å–ø—Ä–∞–≤–ª–µ–Ω–∏–µ: DuckDNS + Cloudflare - –ø—Ä–µ–¥—É–ø—Ä–µ–∂–¥–µ–Ω–∏–µ –Ω–µ –∏—Å—á–µ–∑–∞–µ—Ç –ø–æ—Å–ª–µ 30 –º–∏–Ω—É—Ç

## ‚ö†Ô∏è –í–ê–ñ–ù–û: –î–ª—è –∑–∞–¥–∞–Ω–∏—è —Ç—Ä–µ–±—É–µ—Ç—Å—è ACM, –∞ –Ω–µ Cloudflare!

**–î–ª—è –≤—ã–ø–æ–ª–Ω–µ–Ω–∏—è –∑–∞–¥–∞–Ω–∏—è –Ω—É–∂–Ω–æ:**
- ‚úÖ –ò—Å–ø–æ–ª—å–∑–æ–≤–∞—Ç—å **AWS Certificate Manager (ACM)**
- ‚úÖ –ò—Å–ø–æ–ª—å–∑–æ–≤–∞—Ç—å –¥–æ–º–µ–Ω —Å –ø–æ–¥–¥–µ—Ä–∂–∫–æ–π DNS validation (Freenom/eu.org)
- ‚ùå **–ù–ï Cloudflare** (—ç—Ç–æ –∞–ª—å—Ç–µ—Ä–Ω–∞—Ç–∏–≤–Ω–æ–µ —Ä–µ—à–µ–Ω–∏–µ)

**–ù–æ –µ—Å–ª–∏ –≤—ã —Ö–æ—Ç–∏—Ç–µ –∏—Å–ø—Ä–∞–≤–∏—Ç—å —Ç–µ–∫—É—â—É—é –ø—Ä–æ–±–ª–µ–º—É —Å Cloudflare:**

---

## üîç –î–∏–∞–≥–Ω–æ—Å—Ç–∏–∫–∞ –ø—Ä–æ–±–ª–µ–º—ã

### –ü—Ä–æ–≤–µ—Ä–∫–∞ 1: Universal SSL –≤–∫–ª—é—á–µ–Ω?

1. –í Cloudflare Dashboard: **SSL/TLS** ‚Üí **Edge Certificates**
2. –ù–∞–π–¥–∏—Ç–µ —Ä–∞–∑–¥–µ–ª **"Universal SSL"**
3. –ü—Ä–æ–≤–µ—Ä—å—Ç–µ —Å—Ç–∞—Ç—É—Å:
   - ‚úÖ **Active** –∏–ª–∏ **Enabled** - —Ö–æ—Ä–æ—à–æ
   - ‚ùå **Pending** –∏–ª–∏ **Disabled** - –ø—Ä–æ–±–ª–µ–º–∞!

**–ï—Å–ª–∏ –≤—ã–∫–ª—é—á–µ–Ω –∏–ª–∏ Pending:**
- –ù–∞–∂–º–∏—Ç–µ **Enable Universal SSL**
- –ü–æ–¥–æ–∂–¥–∏—Ç–µ –µ—â–µ 15-30 –º–∏–Ω—É—Ç

### –ü—Ä–æ–≤–µ—Ä–∫–∞ 2: SSL —Ä–µ–∂–∏–º –ø—Ä–∞–≤–∏–ª—å–Ω—ã–π?

1. –í Cloudflare: **SSL/TLS** ‚Üí **Overview**
2. –ü—Ä–æ–≤–µ—Ä—å—Ç–µ —Ä–µ–∂–∏–º:
   - ‚úÖ **Full** - –ø—Ä–∞–≤–∏–ª—å–Ω–æ
   - ‚úÖ **Full (strict)** - –ø—Ä–∞–≤–∏–ª—å–Ω–æ (–Ω–æ —Ç—Ä–µ–±—É–µ—Ç —Å–µ—Ä—Ç–∏—Ñ–∏–∫–∞—Ç –Ω–∞ —Å–µ—Ä–≤–µ—Ä–µ)
   - ‚ùå **Flexible** - –ù–ï–ü–†–ê–í–ò–õ–¨–ù–û!
   - ‚ùå **Off** - –ù–ï–ü–†–ê–í–ò–õ–¨–ù–û!

**–ï—Å–ª–∏ –Ω–µ–ø—Ä–∞–≤–∏–ª—å–Ω—ã–π —Ä–µ–∂–∏–º:**
- –ò–∑–º–µ–Ω–∏—Ç–µ –Ω–∞ **Full**
- –°–æ—Ö—Ä–∞–Ω–∏—Ç–µ

### –ü—Ä–æ–≤–µ—Ä–∫–∞ 3: Always Use HTTPS –≤–∫–ª—é—á–µ–Ω?

1. –í Cloudflare: **SSL/TLS** ‚Üí **Edge Certificates**
2. –ù–∞–π–¥–∏—Ç–µ **"Always Use HTTPS"**
3. –î–æ–ª–∂–µ–Ω –±—ã—Ç—å **–≤–∫–ª—é—á–µ–Ω** (—Å–∏–Ω–∏–π –ø–µ—Ä–µ–∫–ª—é—á–∞—Ç–µ–ª—å)

---

## ‚úÖ –†–ï–®–ï–ù–ò–ï: –ü–æ—à–∞–≥–æ–≤–æ–µ –∏—Å–ø—Ä–∞–≤–ª–µ–Ω–∏–µ

### –®–∞–≥ 1: –ü—Ä–æ–≤–µ—Ä—å—Ç–µ –∏ –≤–∫–ª—é—á–∏—Ç–µ Universal SSL

1. **SSL/TLS** ‚Üí **Edge Certificates** ‚Üí **Universal SSL**
2. –ï—Å–ª–∏ —Å—Ç–∞—Ç—É—Å **Pending** –∏–ª–∏ **Disabled**:
   - –ù–∞–∂–º–∏—Ç–µ **Enable Universal SSL**
   - –ü–æ–¥–æ–∂–¥–∏—Ç–µ 15-30 –º–∏–Ω—É—Ç

**–ü–æ—á–µ–º—É –º–æ–∂–µ—Ç –±—ã—Ç—å Pending:**
- DuckDNS –Ω–µ –ø–æ–¥–¥–µ—Ä–∂–∏–≤–∞–µ—Ç –ø–æ–ª–Ω–æ–µ —É–ø—Ä–∞–≤–ª–µ–Ω–∏–µ DNS —á–µ—Ä–µ–∑ Cloudflare
- Cloudflare –º–æ–∂–µ—Ç —Ç—Ä–µ–±–æ–≤–∞—Ç—å –¥–æ–ø–æ–ª–Ω–∏—Ç–µ–ª—å–Ω—É—é –ø—Ä–æ–≤–µ—Ä–∫—É –¥–æ–º–µ–Ω–∞
- –ú–æ–∂–µ—Ç –ø–æ—Ç—Ä–µ–±–æ–≤–∞—Ç—å—Å—è –¥–æ 24 —á–∞—Å–æ–≤ –¥–ª—è –Ω–µ–∫–æ—Ç–æ—Ä—ã—Ö –¥–æ–º–µ–Ω–æ–≤

### –®–∞–≥ 2: –ò—Å–ø–æ–ª—å–∑—É–π—Ç–µ Origin Certificate (–±—ã—Å—Ç—Ä–æ–µ —Ä–µ—à–µ–Ω–∏–µ)

–ï—Å–ª–∏ Universal SSL –Ω–µ –∞–∫—Ç–∏–≤–∏—Ä—É–µ—Ç—Å—è, –∏—Å–ø–æ–ª—å–∑—É–π—Ç–µ Origin Certificate:

1. –í Cloudflare: **SSL/TLS** ‚Üí **Origin Server**
2. –ù–∞–∂–º–∏—Ç–µ **"Create Certificate"**
3. –ù–∞—Å—Ç—Ä–æ–π–∫–∏:
   - **Private key type:** RSA (2048)
   - **Hostnames:** 
     - `secret-nick.duckdns.org`
     - `*.secret-nick.duckdns.org`
   - **Certificate Validity:** 15 years
4. –ù–∞–∂–º–∏—Ç–µ **"Create"**
5. **–°–∫–æ–ø–∏—Ä—É–π—Ç–µ –∏ —Å–æ—Ö—Ä–∞–Ω–∏—Ç–µ:**
   - **Origin Certificate** (cert.pem)
   - **Private Key** (key.pem)

6. **–ò–º–ø–æ—Ä—Ç–∏—Ä—É–π—Ç–µ –≤ AWS ACM:**
   ```powershell
   # –°–æ—Ö—Ä–∞–Ω–∏—Ç–µ —Å–µ—Ä—Ç–∏—Ñ–∏–∫–∞—Ç—ã –≤ —Ñ–∞–π–ª—ã:
   # certs/cloudflare-origin-cert.pem
   # certs/cloudflare-origin-key.pem

   aws acm import-certificate `
     --certificate fileb://certs/cloudflare-origin-cert.pem `
     --private-key fileb://certs/cloudflare-origin-key.pem `
     --region eu-central-1 `
     --tags Key=Name,Value=secret-nick-cloudflare-ssl
   ```

7. **–ò–∑–º–µ–Ω–∏—Ç–µ SSL —Ä–µ–∂–∏–º –Ω–∞ Full (strict):**
   - **SSL/TLS** ‚Üí **Overview** ‚Üí **Full (strict)**

### –®–∞–≥ 3: –ü—Ä–æ–≤–µ—Ä—å—Ç–µ DNS –∑–∞–ø–∏—Å–∏

1. –í Cloudflare: **DNS** ‚Üí **Records**
2. –£–±–µ–¥–∏—Ç–µ—Å—å, —á—Ç–æ A –∑–∞–ø–∏—Å—å:
   - Type: **A**
   - Name: `@` –∏–ª–∏ `secret-nick`
   - Content: IP –≤–∞—à–µ–≥–æ ALB (–Ω–∞–ø—Ä–∏–º–µ—Ä: `3.124.207.23`)
   - Proxy status: **‚òÅÔ∏è Proxied** (–æ—Ä–∞–Ω–∂–µ–≤–∞—è —Ö–º–∞—Ä–∫–∞)

### –®–∞–≥ 4: –û—á–∏—Å—Ç–∏—Ç–µ –∫–µ—à

1. –û—á–∏—Å—Ç–∏—Ç–µ –∫–µ—à –±—Ä–∞—É–∑–µ—Ä–∞: `Ctrl + Shift + Delete`
2. –û—á–∏—Å—Ç–∏—Ç–µ DNS –∫–µ—à:
   ```powershell
   ipconfig /flushdns
   ```
3. –ü–µ—Ä–µ–∑–∞–ø—É—Å—Ç–∏—Ç–µ –±—Ä–∞—É–∑–µ—Ä
4. –ü—Ä–æ–≤–µ—Ä—å—Ç–µ –≤ —Ä–µ–∂–∏–º–µ –∏–Ω–∫–æ–≥–Ω–∏—Ç–æ

---

## üêõ –ï—Å–ª–∏ –ø—Ä–æ–±–ª–µ–º–∞ —Å–æ—Ö—Ä–∞–Ω—è–µ—Ç—Å—è

### –ü—Ä–æ–±–ª–µ–º–∞: Universal SSL –Ω–µ –∞–∫—Ç–∏–≤–∏—Ä—É–µ—Ç—Å—è

**–ü—Ä–∏—á–∏–Ω–∞:** DuckDNS –Ω–µ –ø–æ–¥–¥–µ—Ä–∂–∏–≤–∞–µ—Ç –ø–æ–ª–Ω–æ–µ —É–ø—Ä–∞–≤–ª–µ–Ω–∏–µ DNS —á–µ—Ä–µ–∑ Cloudflare, –ø–æ—ç—Ç–æ–º—É Universal SSL –º–æ–∂–µ—Ç –Ω–µ —Ä–∞–±–æ—Ç–∞—Ç—å –∞–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏.

**–†–µ—à–µ–Ω–∏–µ:**
1. –ò—Å–ø–æ–ª—å–∑—É–π—Ç–µ **Origin Certificate** (—Å–º. –®–∞–≥ 2 –≤—ã—à–µ)
2. –ò–ª–∏ –ø–µ—Ä–µ–∫–ª—é—á–∏—Ç–µ—Å—å –Ω–∞ –¥–æ–º–µ–Ω —Å –ø–æ–¥–¥–µ—Ä–∂–∫–æ–π nameservers (Freenom/eu.org)

### –ü—Ä–æ–±–ª–µ–º–∞: –ü—Ä–µ–¥—É–ø—Ä–µ–∂–¥–µ–Ω–∏–µ –≤—Å–µ –µ—â–µ –µ—Å—Ç—å –ø–æ—Å–ª–µ 1 —á–∞—Å–∞

**–†–µ—à–µ–Ω–∏–µ:**
1. –ü—Ä–æ–≤–µ—Ä—å—Ç–µ, —á—Ç–æ –≤—ã –∏—Å–ø–æ–ª—å–∑—É–µ—Ç–µ `https://` (–Ω–µ `http://`)
2. –ü—Ä–æ–≤–µ—Ä—å—Ç–µ —á–µ—Ä–µ–∑ –¥—Ä—É–≥–æ–π –±—Ä–∞—É–∑–µ—Ä
3. –ü—Ä–æ–≤–µ—Ä—å—Ç–µ —á–µ—Ä–µ–∑ —Ä–µ–∂–∏–º –∏–Ω–∫–æ–≥–Ω–∏—Ç–æ
4. –ü–æ–¥–æ–∂–¥–∏—Ç–µ –µ—â–µ 1-2 —á–∞—Å–∞ (–∏–Ω–æ–≥–¥–∞ —Ç—Ä–µ–±—É–µ—Ç—Å—è –±–æ–ª—å—à–µ –≤—Ä–µ–º–µ–Ω–∏)

### –ü—Ä–æ–±–ª–µ–º–∞: Cloudflare –ø–æ–∫–∞–∑—ã–≤–∞–µ—Ç –æ—à–∏–±–∫—É

**–†–µ—à–µ–Ω–∏–µ:**
1. –ü—Ä–æ–≤–µ—Ä—å—Ç–µ, —á—Ç–æ –≤–∞—à ALB –¥–æ—Å—Ç—É–ø–µ–Ω:
   ```powershell
   curl http://app-alb-1868129411.eu-central-1.elb.amazonaws.com
   ```

2. –ü—Ä–æ–≤–µ—Ä—å—Ç–µ Security Group:
   - –ü–æ—Ä—Ç 80 –¥–æ–ª–∂–µ–Ω –±—ã—Ç—å –æ—Ç–∫—Ä—ã—Ç –¥–ª—è Cloudflare IP ranges
   - –î–æ–±–∞–≤—å—Ç–µ: https://www.cloudflare.com/ips/

---

## üéØ –î–õ–Ø –í–´–ü–û–õ–ù–ï–ù–ò–Ø –ó–ê–î–ê–ù–ò–Ø: –ò—Å–ø–æ–ª—å–∑—É–π—Ç–µ ACM –≤–º–µ—Å—Ç–æ Cloudflare

**–í–∞–∂–Ω–æ:** –î–ª—è –∑–∞–¥–∞–Ω–∏—è —Ç—Ä–µ–±—É–µ—Ç—Å—è **AWS Certificate Manager (ACM)**, –∞ –Ω–µ Cloudflare!

### –ß—Ç–æ –Ω—É–∂–Ω–æ —Å–¥–µ–ª–∞—Ç—å:

1. **–ó–∞—Ä–µ–≥–∏—Å—Ç—Ä–∏—Ä–æ–≤–∞—Ç—å –¥–æ–º–µ–Ω –Ω–∞ Freenom** (–Ω–µ DuckDNS):
   - [freenom.com](https://www.freenom.com)
   - –í—ã–±–µ—Ä–∏—Ç–µ –¥–æ–º–µ–Ω `.tk` (–Ω–∞–ø—Ä–∏–º–µ—Ä: `secretnick.tk`)

2. **–û–±–Ω–æ–≤–∏—Ç—å Terraform:**
   ```hcl
   enable_https = true
   domain_name = "secretnick.tk"  # –ù–æ–≤—ã–π –¥–æ–º–µ–Ω
   create_route53_zone = true
   ```

3. **–†–∞–∑–≤–µ—Ä–Ω—É—Ç—å —á–µ—Ä–µ–∑ Terraform:**
   ```powershell
   cd terraform
   terraform apply
   ```

4. **–ù–∞—Å—Ç—Ä–æ–∏—Ç—å Name Servers –≤ Freenom**

**–ü–æ–¥—Ä–æ–±–Ω–∞—è –∏–Ω—Å—Ç—Ä—É–∫—Ü–∏—è:** [assignment-acm-ssl-setup.md](./assignment-acm-ssl-setup.md)

---

## ‚úÖ –ß–µ–∫–ª–∏—Å—Ç –∏—Å–ø—Ä–∞–≤–ª–µ–Ω–∏—è Cloudflare

- [ ] Universal SSL –≤–∫–ª—é—á–µ–Ω (Active/Enabled)
- [ ] SSL —Ä–µ–∂–∏–º —É—Å—Ç–∞–Ω–æ–≤–ª–µ–Ω –Ω–∞ **Full**
- [ ] **Always Use HTTPS** –≤–∫–ª—é—á–µ–Ω
- [ ] A –∑–∞–ø–∏—Å—å –∏–º–µ–µ—Ç —Å—Ç–∞—Ç—É—Å **Proxied** (–æ—Ä–∞–Ω–∂–µ–≤–∞—è —Ö–º–∞—Ä–∫–∞)
- [ ] –ü–æ–¥–æ–∂–¥–∞–ª–∏ 30-60 –º–∏–Ω—É—Ç –ø–æ—Å–ª–µ –∏–∑–º–µ–Ω–µ–Ω–∏–π
- [ ] –û—á–∏—Å—Ç–∏–ª–∏ –∫–µ—à –±—Ä–∞—É–∑–µ—Ä–∞ –∏ DNS
- [ ] –ü—Ä–æ–≤–µ—Ä–∏–ª–∏ –≤ —Ä–µ–∂–∏–º–µ –∏–Ω–∫–æ–≥–Ω–∏—Ç–æ
- [ ] –ï—Å–ª–∏ –Ω–µ –ø–æ–º–æ–≥–ª–æ - –∏—Å–ø–æ–ª—å–∑–æ–≤–∞–ª–∏ Origin Certificate

---

## üìö –î–æ–ø–æ–ª–Ω–∏—Ç–µ–ª—å–Ω—ã–µ —Ä–µ—Å—É—Ä—Å—ã

- **–î–ª—è –∑–∞–¥–∞–Ω–∏—è:** [assignment-acm-ssl-setup.md](./assignment-acm-ssl-setup.md)
- **Cloudflare SSL:** [cloudflare-ssl-setup.md](./cloudflare-ssl-setup.md)
- **–ò—Å–ø—Ä–∞–≤–ª–µ–Ω–∏–µ —Å–µ—Ä—Ç–∏—Ñ–∏–∫–∞—Ç–∞:** [fix-certificate-not-covered.md](./fix-certificate-not-covered.md)

---

**–†–µ–∫–æ–º–µ–Ω–¥–∞—Ü–∏—è:** –î–ª—è –≤—ã–ø–æ–ª–Ω–µ–Ω–∏—è –∑–∞–¥–∞–Ω–∏—è –ª—É—á—à–µ –∏—Å–ø–æ–ª—å–∑–æ–≤–∞—Ç—å ACM —Å Freenom –¥–æ–º–µ–Ω–æ–º, —Ç–∞–∫ –∫–∞–∫ —ç—Ç–æ —Å–æ–æ—Ç–≤–µ—Ç—Å—Ç–≤—É–µ—Ç —Ç—Ä–µ–±–æ–≤–∞–Ω–∏—è–º –∑–∞–¥–∞–Ω–∏—è –∏ —Ä–∞–±–æ—Ç–∞–µ—Ç –±–æ–ª–µ–µ –Ω–∞–¥–µ–∂–Ω–æ.


