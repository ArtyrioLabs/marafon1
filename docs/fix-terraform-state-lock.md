# üîì –†–∞–∑–±–ª–æ–∫–∏—Ä–æ–≤–∫–∞ Terraform State Lock

## –ü—Ä–æ–±–ª–µ–º–∞

```
Error: Error acquiring the state lock
Lock Info:
  ID:        9ec3915f-f5f6-0d93-a6b5-2a87e46b699b
  Path:      artyriolabs/terraform.tfstate
  Operation: OperationTypeApply
  Who:       runner@runnervmw9dnm
  Created:   2025-11-08 15:04:34
```

–≠—Ç–æ –æ–∑–Ω–∞—á–∞–µ—Ç, —á—Ç–æ –ø—Ä–µ–¥—ã–¥—É—â–∏–π `terraform apply` –≤—Å–µ –µ—â–µ –≤—ã–ø–æ–ª–Ω—è–µ—Ç—Å—è –∏–ª–∏ –∑–∞–≤–∏—Å.

---

## ‚úÖ –†–µ—à–µ–Ω–∏–µ 1: –î–æ–∂–¥–∞—Ç—å—Å—è –∑–∞–≤–µ—Ä—à–µ–Ω–∏—è (—Ä–µ–∫–æ–º–µ–Ω–¥—É–µ—Ç—Å—è)

–ï—Å–ª–∏ terraform apply –≤—Å–µ –µ—â–µ –≤—ã–ø–æ–ª–Ω—è–µ—Ç—Å—è –≤ GitHub Actions:
1. –ü—Ä–æ–≤–µ—Ä—å—Ç–µ —Å—Ç–∞—Ç—É—Å workflow –≤ GitHub Actions
2. –î–æ–∂–¥–∏—Ç–µ—Å—å –∑–∞–≤–µ—Ä—à–µ–Ω–∏—è –ø—Ä–µ–¥—ã–¥—É—â–µ–≥–æ –∑–∞–ø—É—Å–∫–∞
3. –ó–∞—Ç–µ–º –ø–æ–≤—Ç–æ—Ä–∏—Ç–µ –∑–∞–ø—É—Å–∫

---

## ‚ö†Ô∏è –†–µ—à–µ–Ω–∏–µ 2: –ü—Ä–∏–Ω—É–¥–∏—Ç–µ–ª—å–Ω–∞—è —Ä–∞–∑–±–ª–æ–∫–∏—Ä–æ–≤–∫–∞ (–µ—Å–ª–∏ –ø—Ä–æ—Ü–µ—Å—Å –∑–∞–≤–∏—Å)

**‚ö†Ô∏è –í–ù–ò–ú–ê–ù–ò–ï:** –ò—Å–ø–æ–ª—å–∑—É–π—Ç–µ —Ç–æ–ª—å–∫–æ –µ—Å–ª–∏ —É–≤–µ—Ä–µ–Ω—ã, —á—Ç–æ –ø—Ä–µ–¥—ã–¥—É—â–∏–π –ø—Ä–æ—Ü–µ—Å—Å –∑–∞–≤–µ—Ä—à–∏–ª—Å—è –∏–ª–∏ –∑–∞–≤–∏—Å!

### –í–∞—Ä–∏–∞–Ω—Ç A: –ß–µ—Ä–µ–∑ Terraform –∫–æ–º–∞–Ω–¥—É

```bash
terraform force-unlock 9ec3915f-f5f6-0d93-a6b5-2a87e46b699b
```

### –í–∞—Ä–∏–∞–Ω—Ç B: –ß–µ—Ä–µ–∑ AWS CLI (—É–¥–∞–ª–∏—Ç—å lock —Ñ–∞–π–ª –∏–∑ S3)

```bash
# –£–¥–∞–ª–∏—Ç—å lock —Ñ–∞–π–ª –∏–∑ S3
aws s3 rm s3://artyriolabs/terraform.tfstate.lock --region eu-central-1
```

### –í–∞—Ä–∏–∞–Ω—Ç C: –í GitHub Actions workflow

–î–æ–±–∞–≤—å—Ç–µ —à–∞–≥ –¥–ª—è —Ä–∞–∑–±–ª–æ–∫–∏—Ä–æ–≤–∫–∏ –ø–µ—Ä–µ–¥ terraform plan:

```yaml
- name: Force unlock Terraform state (if needed)
  if: failure()
  run: |
    terraform force-unlock -force 9ec3915f-f5f6-0d93-a6b5-2a87e46b699b || true
```

---

## üîç –ü—Ä–æ–≤–µ—Ä–∫–∞ –±–ª–æ–∫–∏—Ä–æ–≤–∫–∏

### –ü—Ä–æ–≤–µ—Ä–∏—Ç—å lock —Ñ–∞–π–ª –≤ S3:

```bash
aws s3 ls s3://artyriolabs/terraform.tfstate.lock --region eu-central-1
```

### –ü—Ä–æ–≤–µ—Ä–∏—Ç—å —Å—Ç–∞—Ç—É—Å –≤ Terraform:

```bash
terraform plan
# –ï—Å–ª–∏ –µ—Å—Ç—å lock, —É–≤–∏–¥–∏—Ç–µ –æ—à–∏–±–∫—É —Å Lock Info
```

---

## üìã –†–µ–∫–æ–º–µ–Ω–¥–∞—Ü–∏–∏

1. **–°–Ω–∞—á–∞–ª–∞ –ø—Ä–æ–≤–µ—Ä—å—Ç–µ GitHub Actions** - –≤–æ–∑–º–æ–∂–Ω–æ, terraform apply –≤—Å–µ –µ—â–µ –≤—ã–ø–æ–ª–Ω—è–µ—Ç—Å—è
2. **–ü–æ–¥–æ–∂–¥–∏—Ç–µ 5-10 –º–∏–Ω—É—Ç** - –µ—Å–ª–∏ –ø—Ä–æ—Ü–µ—Å—Å –∞–∫—Ç–∏–≤–µ–Ω, –æ–Ω –¥–æ–ª–∂–µ–Ω –∑–∞–≤–µ—Ä—à–∏—Ç—å—Å—è
3. **–¢–æ–ª—å–∫–æ –ø–æ—Ç–æ–º —Ä–∞–∑–±–ª–æ–∫–∏—Ä—É–π—Ç–µ** - –µ—Å–ª–∏ —É–≤–µ—Ä–µ–Ω—ã, —á—Ç–æ –ø—Ä–æ—Ü–µ—Å—Å –∑–∞–≤–∏—Å

---

## üö® –í–∞–∂–Ω–æ

- **–ù–ï —Ä–∞–∑–±–ª–æ–∫–∏—Ä—É–π—Ç–µ**, –µ—Å–ª–∏ terraform apply –≤—Å–µ –µ—â–µ –≤—ã–ø–æ–ª–Ω—è–µ—Ç—Å—è - —ç—Ç–æ –º–æ–∂–µ—Ç –ø—Ä–∏–≤–µ—Å—Ç–∏ –∫ –ø–æ–≤—Ä–µ–∂–¥–µ–Ω–∏—é —Å–æ—Å—Ç–æ—è–Ω–∏—è
- **–†–∞–∑–±–ª–æ–∫–∏—Ä—É–π—Ç–µ —Ç–æ–ª—å–∫–æ**, –µ—Å–ª–∏ –ø—Ä–æ—Ü–µ—Å—Å —Ç–æ—á–Ω–æ –∑–∞–≤–∏—Å –∏–ª–∏ –∑–∞–≤–µ—Ä—à–∏–ª—Å—è —Å –æ—à–∏–±–∫–æ–π
- –ü–æ—Å–ª–µ —Ä–∞–∑–±–ª–æ–∫–∏—Ä–æ–≤–∫–∏ –ø—Ä–æ–≤–µ—Ä—å—Ç–µ —Å–æ—Å—Ç–æ—è–Ω–∏–µ: `terraform plan`


