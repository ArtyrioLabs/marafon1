# SSL Setup with DuckDNS

## –ü–æ—Ç–æ—á–Ω–∏–π —Å—Ç–∞—Ç—É—Å
‚úÖ –î–æ–º–µ–Ω –∑–∞—Ä–µ—î—Å—Ç—Ä–æ–≤–∞–Ω–æ: `secret-nick.duckdns.org`  
‚úÖ Terraform –Ω–∞–ª–∞—à—Ç–æ–≤–∞–Ω–æ: `enable_https = true`  
‚úÖ Security Group –≤—ñ–¥–∫—Ä–∏—Ç–æ –ø–æ—Ä—Ç 443

## –ù–∞—Å—Ç—É–ø–Ω—ñ –∫—Ä–æ–∫–∏

### –ö—Ä–æ–∫ 1: –ó–Ω–∞–π—Ç–∏ DNS —ñ–º'—è ALB

1. –í—ñ–¥–∫—Ä–∏–π—Ç–µ AWS Console ‚Üí EC2 ‚Üí Load Balancers
2. –ó–Ω–∞–π–¥—ñ—Ç—å –≤–∞—à ALB (–º–∞—î –±—É—Ç–∏ `app-alb` –∞–±–æ –ø–æ–¥—ñ–±–Ω–∏–π)
3. –°–∫–æ–ø—ñ—é–π—Ç–µ **DNS name** (—â–æ—Å—å —Ç–∏–ø—É `app-alb-123456789.eu-central-1.elb.amazonaws.com`)

### –ö—Ä–æ–∫ 2: –°—Ç–≤–æ—Ä–∏—Ç–∏ CNAME –∑–∞–ø–∏—Å –¥–ª—è DuckDNS

**–ü—Ä–æ–±–ª–µ–º–∞:** DuckDNS –ø—ñ–¥—Ç—Ä–∏–º—É—î —Ç—ñ–ª—å–∫–∏ A records (IP –∞–¥—Ä–µ—Å–∏), –Ω–µ –ø—ñ–¥—Ç—Ä–∏–º—É—î CNAME.

**–†—ñ—à–µ–Ω–Ω—è:** –ü–æ—Ç—Ä—ñ–±–Ω–æ –∑–Ω–∞–π—Ç–∏ IP –∞–¥—Ä–µ—Å—É ALB:

```bash
# –í PowerShell –∞–±–æ CMD
nslookup app-alb-YOUR-ID.eu-central-1.elb.amazonaws.com
```

–ê–±–æ –≤ Linux/Mac:
```bash
dig app-alb-YOUR-ID.eu-central-1.elb.amazonaws.com
```

### –ö—Ä–æ–∫ 3: –û–Ω–æ–≤–∏—Ç–∏ DuckDNS –∑ IP ALB

1. –ô–¥—ñ—Ç—å –Ω–∞ https://www.duckdns.org/
2. –í –ø–æ–ª—ñ **current ip** –¥–ª—è –¥–æ–º–µ–Ω—É `secret-nick` –≤—Å—Ç–∞–≤—Ç–µ IP –∞–¥—Ä–µ—Å—É ALB
3. –ù–∞—Ç–∏—Å–Ω—ñ—Ç—å **update ip**

‚ö†Ô∏è **–í–∞–∂–ª–∏–≤–æ:** ALB IP –º–æ–∂–µ –∑–º—ñ–Ω–∏—Ç–∏—Å—è! AWS –Ω–µ –≥–∞—Ä–∞–Ω—Ç—É—î —Å—Ç–∞—Ç–∏—á–Ω—É IP –¥–ª—è ALB.

### –ö—Ä–æ–∫ 4: –ó–∞–¥–µ–ø–ª–æ—ó—Ç–∏ SSL –º–æ–¥—É–ª—å

#### –ß–µ—Ä–µ–∑ GitHub Actions:

1. –ó–∞–∫–æ–º—ñ—Ç—å—Ç–µ —Ç–∞ –∑–∞–ø—É—à—Ç–µ –∑–º—ñ–Ω–∏:
```bash
git add terraform/terraform.tfvars
git commit -m "feat: configure SSL for secret-nick.duckdns.org"
git push marafon1 main
```

2. –ô–¥—ñ—Ç—å –Ω–∞ GitHub ‚Üí Actions
3. –ó–∞–ø—É—Å—Ç—ñ—Ç—å workflow **terraform AWS deployment** –∑ –ø–∞—Ä–∞–º–µ—Ç—Ä–∞–º–∏:
   - **action**: `apply`
   - **module**: `dns-ssl`
   - **environment**: `production`

#### –ê–±–æ –ª–æ–∫–∞–ª—å–Ω–æ (—è–∫—â–æ —î terraform):

```bash
cd terraform
terraform init
terraform apply -target=module.dns_ssl
```

### –ö—Ä–æ–∫ 5: –í–∞–ª—ñ–¥–∞—Ü—ñ—è —Å–µ—Ä—Ç–∏—Ñ—ñ–∫–∞—Ç—É

AWS ACM —Å—Ç–≤–æ—Ä–∏—Ç—å —Å–µ—Ä—Ç–∏—Ñ—ñ–∫–∞—Ç —ñ –ø–æ—á–Ω–µ –≤–∞–ª—ñ–¥–∞—Ü—ñ—é —á–µ—Ä–µ–∑ DNS.

**–î–ª—è DuckDNS (DNS validation –Ω–µ –ø—Ä–∞—Ü—é—î –∞–≤—Ç–æ–º–∞—Ç–∏—á–Ω–æ):**

–ü–æ—Ç—Ä—ñ–±–Ω–æ –Ω–∞–ª–∞—à—Ç—É–≤–∞—Ç–∏ **HTTP validation** –∞–±–æ –≤–∏–∫–æ—Ä–∏—Å—Ç–∞—Ç–∏ **DNS validation –≤—Ä—É—á–Ω—É**.

#### –í–∞—Ä—ñ–∞–Ω—Ç A: HTTP Validation (–ø—Ä–æ—Å—Ç—ñ—à–∏–π)

–ó–º—ñ–Ω—ñ—Ç—å –º–æ–¥—É–ª—å DNS-SSL –¥–ª—è –≤–∏–∫–æ—Ä–∏—Å—Ç–∞–Ω–Ω—è HTTP validation:

```hcl
validation_method = "HTTP"  # –∑–∞–º—ñ—Å—Ç—å DNS
```

AWS –±—É–¥–µ –ø–µ—Ä–µ–≤—ñ—Ä—è—Ç–∏ —á–µ—Ä–µ–∑ HTTP –∑–∞–ø–∏—Ç –¥–æ `http://secret-nick.duckdns.org/.well-known/acme-challenge/...`

#### –í–∞—Ä—ñ–∞–Ω—Ç B: DNS Validation –≤—Ä—É—á–Ω—É

1. –ü—ñ—Å–ª—è apply terraform –ø–æ–∫–∞–∂–µ DNS records –¥–ª—è –≤–∞–ª—ñ–¥–∞—Ü—ñ—ó:
```
certificate_validation_records = {
  "secret-nick.duckdns.org" = {
    name  = "_acme-challenge.secret-nick.duckdns.org"
    type  = "CNAME"
    value = "_123abc456def.acm-validations.aws."
  }
}
```

2. **–ü—Ä–æ–±–ª–µ–º–∞:** DuckDNS –Ω–µ –ø—ñ–¥—Ç—Ä–∏–º—É—î CNAME records –¥–ª—è –ø—ñ–¥–¥–æ–º–µ–Ω—ñ–≤.

### –†–µ–∫–æ–º–µ–Ω–¥–æ–≤–∞–Ω–µ —Ä—ñ—à–µ–Ω–Ω—è: –í–∏–∫–æ—Ä–∏—Å—Ç–∞—Ç–∏ Route53

–û—Å–∫—ñ–ª—å–∫–∏ DuckDNS –º–∞—î –æ–±–º–µ–∂–µ–Ω–Ω—è, –Ω–∞–π–∫—Ä–∞—â–µ –≤–∏–∫–æ—Ä–∏—Å—Ç–∞—Ç–∏ **AWS Route53** –¥–ª—è –ø–æ–≤–Ω–æ–≥–æ –∫–æ–Ω—Ç—Ä–æ–ª—é:

1. –í–∏–¥–∞–ª–∏—Ç–∏ –¥–æ–º–µ–Ω –∑ DuckDNS (–∞–±–æ –∑–∞–ª–∏—à–∏—Ç–∏ —è–∫ —î)
2. –ó–∞—Ä–µ—î—Å—Ç—Ä—É–≤–∞—Ç–∏ –±–µ–∑–∫–æ—à—Ç–æ–≤–Ω–∏–π –¥–æ–º–µ–Ω –Ω–∞ https://nic.eu.org/ (*.eu.org)
3. –í–∏–∫–æ—Ä–∏—Å—Ç–∞—Ç–∏ Route53 –¥–ª—è DNS management
4. ACM –∞–≤—Ç–æ–º–∞—Ç–∏—á–Ω–æ –≤–∞–ª—ñ–¥—É—î —á–µ—Ä–µ–∑ Route53

**–ê–±–æ** –≤–∏–∫–æ—Ä–∏—Å—Ç–∞—Ç–∏ Let's Encrypt + Certbot –∑–∞–º—ñ—Å—Ç—å ACM.

## –ê–ª—å—Ç–µ—Ä–Ω–∞—Ç–∏–≤–Ω–µ —Ä—ñ—à–µ–Ω–Ω—è: Let's Encrypt –∑ Certbot

–Ø–∫—â–æ —Ö–æ—á–µ—Ç–µ –≤–∏–∫–æ—Ä–∏—Å—Ç–∞—Ç–∏ DuckDNS, –º–æ–∂–Ω–∞ –Ω–∞–ª–∞—à—Ç—É–≤–∞—Ç–∏ Let's Encrypt:

1. SSH –¥–æ EC2 —ñ–Ω—Å—Ç–∞–Ω—Å—É
2. –í—Å—Ç–∞–Ω–æ–≤–∏—Ç–∏ Certbot
3. –ù–∞–ª–∞—à—Ç—É–≤–∞—Ç–∏ DuckDNS plugin –¥–ª—è Certbot
4. –ó–≥–µ–Ω–µ—Ä—É–≤–∞—Ç–∏ —Å–µ—Ä—Ç–∏—Ñ—ñ–∫–∞—Ç
5. –ó–∞–≤–∞–Ω—Ç–∞–∂–∏—Ç–∏ –≤ ACM –∞–±–æ –≤–∏–∫–æ—Ä–∏—Å—Ç–∞—Ç–∏ –Ω–∞ ALB

### –ö–æ–º–∞–Ω–¥–∏ –¥–ª—è Certbot:

```bash
# –ù–∞ EC2 —ñ–Ω—Å—Ç–∞–Ω—Å—ñ
sudo yum install -y certbot

# –û—Ç—Ä–∏–º–∞—Ç–∏ —Å–µ—Ä—Ç–∏—Ñ—ñ–∫–∞—Ç (–ø–æ—Ç—Ä–µ–±—É—î DuckDNS token)
certbot certonly --manual \
  --preferred-challenges dns \
  --email your@email.com \
  -d secret-nick.duckdns.org
```

## –†–µ–∫–æ–º–µ–Ω–¥–∞—Ü—ñ—è

**–ù–∞–π–ø—Ä–æ—Å—Ç—ñ—à–∏–π –≤–∞—Ä—ñ–∞–Ω—Ç –¥–ª—è production:**

1. –ó–∞—Ä–µ—î—Å—Ç—Ä—É–π—Ç–µ –¥–æ–º–µ–Ω –Ω–∞ https://www.freenom.com/ (.tk, .ml, .ga, .cf, .gq - –±–µ–∑–∫–æ—à—Ç–æ–≤–Ω–æ)
2. –ê–±–æ –Ω–∞ https://nic.eu.org/ (.eu.org - –±–µ–∑–∫–æ—à—Ç–æ–≤–Ω–æ, –∞–ª–µ –ø–æ—Ç—Ä—ñ–±–Ω–æ 1-2 –¥–Ω—ñ –Ω–∞ –º–æ–¥–µ—Ä–∞—Ü—ñ—é)
3. –í–∏–∫–æ—Ä–∏—Å—Ç–∞–π—Ç–µ Route53 –¥–ª—è DNS
4. AWS ACM –∞–≤—Ç–æ–º–∞—Ç–∏—á–Ω–æ –∑–≥–µ–Ω–µ—Ä—É—î —ñ –æ–Ω–æ–≤–ª—é–≤–∞—Ç–∏–º–µ SSL —Å–µ—Ä—Ç–∏—Ñ—ñ–∫–∞—Ç

–¶–µ –∑–∞–±–µ–∑–ø–µ—á–∏—Ç—å:
- ‚úÖ –ê–≤—Ç–æ–º–∞—Ç–∏—á–Ω—É –≤–∞–ª—ñ–¥–∞—Ü—ñ—é —Å–µ—Ä—Ç–∏—Ñ—ñ–∫–∞—Ç—É
- ‚úÖ –ê–≤—Ç–æ–º–∞—Ç–∏—á–Ω–µ –æ–Ω–æ–≤–ª–µ–Ω–Ω—è —Å–µ—Ä—Ç–∏—Ñ—ñ–∫–∞—Ç—É –∫–æ–∂–Ω—ñ 90 –¥–Ω—ñ–≤
- ‚úÖ –Ü–Ω—Ç–µ–≥—Ä–∞—Ü—ñ—é –∑ ALB
- ‚úÖ –ü—ñ–¥—Ç—Ä–∏–º–∫—É DNSSEC

## –ü–æ—Ç–æ—á–Ω–∏–π —Å—Ç–∞—Ç—É—Å –¥–ª—è secret-nick.duckdns.org

–©–æ–± –ø—Ä–æ–¥–æ–≤–∂–∏—Ç–∏ –∑ DuckDNS:

1. ‚úÖ –î–æ–º–µ–Ω —Å—Ç–≤–æ—Ä–µ–Ω–æ
2. üîÑ –ü–æ—Ç—Ä—ñ–±–Ω–æ –æ–Ω–æ–≤–∏—Ç–∏ IP –Ω–∞ DuckDNS (–¥–∏–≤. –ö—Ä–æ–∫ 2-3 –≤–∏—â–µ)
3. ‚è≥ –ó–∞–¥–µ–ø–ª–æ—ó—Ç–∏ SSL –º–æ–¥—É–ª—å (–ö—Ä–æ–∫ 4)
4. ‚ùå DNS validation –Ω–µ —Å–ø—Ä–∞—Ü—é—î –∞–≤—Ç–æ–º–∞—Ç–∏—á–Ω–æ (DuckDNS –æ–±–º–µ–∂–µ–Ω–Ω—è)
5. üîÑ –ü–æ—Ç—Ä—ñ–±–Ω–æ –Ω–∞–ª–∞—à—Ç—É–≤–∞—Ç–∏ HTTP validation –∞–±–æ –≤–∏–∫–æ—Ä–∏—Å—Ç–∞—Ç–∏ —ñ–Ω—à–∏–π –¥–æ–º–µ–Ω

**–†–µ–∫–æ–º–µ–Ω–¥—É—é:** –Ø–∫—â–æ —Ü–µ –¥–ª—è production, –∫—Ä–∞—â–µ –≤–∏—Ç—Ä–∞—Ç–∏—Ç–∏ 1 –¥–µ–Ω—å –Ω–∞ —Ä–µ—î—Å—Ç—Ä–∞—Ü—ñ—é .eu.org –¥–æ–º–µ–Ω—É.
