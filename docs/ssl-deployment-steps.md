# SSL/TLS Deployment - Quick Start

## –ü–æ—Ç–æ—á–Ω–∏–π —Å—Ç–∞–Ω ‚úÖ
- ‚úÖ EC2 —ñ–Ω—Å—Ç–∞–Ω—Å–∏ –∑–∞–ø—É—â–µ–Ω—ñ (dotnet, react, angular)
- ‚úÖ ALB —Å—Ç–≤–æ—Ä–µ–Ω–∏–π
- ‚úÖ –ü–æ—Ä—Ç 443 –¥–æ–¥–∞–Ω–æ –≤ Security Group
- ‚úÖ Terraform –∫–æ–Ω—Ñ—ñ–≥—É—Ä–∞—Ü—ñ—è –≥–æ—Ç–æ–≤–∞

## –©–æ –ø–æ—Ç—Ä—ñ–±–Ω–æ –∑—Ä–æ–±–∏—Ç–∏ üéØ

### –ö—Ä–æ–∫ 1: –ó–∞—Ä–µ—î—Å—Ç—Ä—É–≤–∞—Ç–∏ –¥–æ–º–µ–Ω (5 —Ö–≤–∏–ª–∏–Ω)

**–í–∞—Ä—ñ–∞–Ω—Ç A: DuckDNS (–Ω–∞–π–ø—Ä–æ—Å—Ç—ñ—à–∏–π)**

1. –í—ñ–¥–∫—Ä–∏–π—Ç–µ https://www.duckdns.org/
2. –£–≤—ñ–π–¥—ñ—Ç—å —á–µ—Ä–µ–∑ GitHub –∞–±–æ Google
3. –í–≤–µ–¥—ñ—Ç—å –±–∞–∂–∞–Ω–µ —ñ–º'—è (–Ω–∞–ø—Ä–∏–∫–ª–∞–¥, `marafon-app`)
4. –ù–∞—Ç–∏—Å–Ω—ñ—Ç—å "add domain" ‚Üí –æ—Ç—Ä–∏–º–∞—î—Ç–µ `marafon-app.duckdns.org`
5. –°–∫–æ–ø—ñ—é–π—Ç–µ –≤–∞—à —Ç–æ–∫–µ–Ω (–∑–±–µ—Ä—ñ–≥–∞–π—Ç–µ –π–æ–≥–æ!)

**–í–∞—Ä—ñ–∞–Ω—Ç B: FreeDNS**

1. –í—ñ–¥–∫—Ä–∏–π—Ç–µ https://freedns.afraid.org/
2. –ó–∞—Ä–µ—î—Å—Ç—Ä—É–π—Ç–µ—Å—å
3. –í–∏–±–µ—Ä—ñ—Ç—å –±–µ–∑–∫–æ—à—Ç–æ–≤–Ω–∏–π –ø—ñ–¥–¥–æ–º–µ–Ω
4. –°—Ç–≤–æ—Ä—ñ—Ç—å A-record

**–í–∞—Ä—ñ–∞–Ω—Ç C: EU.ORG (–∑–∞–π–º–∞—î 1-2 –¥–Ω—ñ)**

1. –í—ñ–¥–∫—Ä–∏–π—Ç–µ https://nic.eu.org/
2. –ó–∞—Ä–µ—î—Å—Ç—Ä—É–π—Ç–µ –¥–æ–º–µ–Ω —Ç–∏–ø—É `yourapp.eu.org`
3. –î–æ—á–µ–∫–∞–π—Ç–µ—Å—å —Å—Ö–≤–∞–ª–µ–Ω–Ω—è (1-2 –¥–Ω—ñ)

### –ö—Ä–æ–∫ 2: –û–Ω–æ–≤–∏—Ç–∏ terraform.tfvars

–í—ñ–¥–∫—Ä–∏–π—Ç–µ `terraform/terraform.tfvars` —ñ –∑–º—ñ–Ω—ñ—Ç—å:

```hcl
# –ó–º—ñ–Ω—ñ—Ç—å –Ω–∞ –≤–∞—à –∑–∞—Ä–µ—î—Å—Ç—Ä–æ–≤–∞–Ω–∏–π –¥–æ–º–µ–Ω:
domain_name = "marafon-app.duckdns.org"  # <-- –í–ê–® –î–û–ú–ï–ù –¢–£–¢

enable_https = true

# –î–ª—è DuckDNS –≤—Å—Ç–∞–Ω–æ–≤—ñ—Ç—å false (–∫–µ—Ä—É—î–º–æ DNS –≤—Ä—É—á–Ω—É)
# –î–ª—è –≤–ª–∞—Å–Ω–æ–≥–æ –¥–æ–º–µ–Ω—É - true (Route53 –∫–µ—Ä—É—î DNS)
create_route53_zone = false  # false –¥–ª—è DuckDNS, true –¥–ª—è –≤–ª–∞—Å–Ω–æ–≥–æ –¥–æ–º–µ–Ω—É
```

### –ö—Ä–æ–∫ 3: –ó–∞–∫–æ–º—ñ—Ç–∏—Ç–∏ —Ç–∞ –∑–∞–ø—É—à–∏—Ç–∏ –∑–º—ñ–Ω–∏

```bash
git add terraform/terraform.tfvars
git commit -m "feat: configure SSL for marafon-app.duckdns.org"
git push marafon1 main
```

### –ö—Ä–æ–∫ 4: –û—Ç—Ä–∏–º–∞—Ç–∏ ALB DNS –∞–¥—Ä–µ—Å—É

1. –ô–¥—ñ—Ç—å –≤ AWS Console ‚Üí EC2 ‚Üí Load Balancers
2. –í–∏–±–µ—Ä—ñ—Ç—å –≤–∞—à ALB (app-alb)
3. –°–∫–æ–ø—ñ—é–π—Ç–µ "DNS name" (–±—É–¥–µ –≤–∏–≥–ª—è–¥–∞—Ç–∏ —è–∫ `app-alb-123456789.eu-central-1.elb.amazonaws.com`)

–ê–ë–û —á–µ—Ä–µ–∑ GitHub Actions outputs –ø—ñ—Å–ª—è –ø–æ–ø–µ—Ä–µ–¥–Ω—å–æ–≥–æ –¥–µ–ø–ª–æ—é.

### –ö—Ä–æ–∫ 5: –ù–∞–ª–∞—à—Ç—É–≤–∞—Ç–∏ DNS (–∑–∞–ª–µ–∂–∏—Ç—å –≤—ñ–¥ –ø—Ä–æ–≤–∞–π–¥–µ—Ä–∞)

#### –î–ª—è DuckDNS:

1. –ô–¥—ñ—Ç—å –Ω–∞ https://www.duckdns.org/
2. –£–≤—ñ–π–¥—ñ—Ç—å —ñ –∑–Ω–∞–π–¥—ñ—Ç—å –≤–∞—à –¥–æ–º–µ–Ω `marafon-app`
3. –í –ø–æ–ª—ñ "current ip" –≤—Å—Ç–∞–≤—Ç–µ **ALB DNS –∞–¥—Ä–µ—Å—É** (–Ω–µ IP!)
4. –ù–∞—Ç–∏—Å–Ω—ñ—Ç—å "update ip"

‚ö†Ô∏è **–í–∞–∂–ª–∏–≤–æ**: DuckDNS –æ—á—ñ–∫—É—î IP, –∞–ª–µ AWS ALB –º–∞—î –¥–∏–Ω–∞–º—ñ—á–Ω–∏–π IP. –¢–æ–º—É –ø–æ—Ç—Ä—ñ–±–Ω–æ:
- –í–∏–∫–æ—Ä–∏—Å—Ç–æ–≤—É–≤–∞—Ç–∏ CNAME –∑–∞–ø–∏—Å (—è–∫—â–æ –ø—Ä–æ–≤–∞–π–¥–µ—Ä –ø—ñ–¥—Ç—Ä–∏–º—É—î)
- –ê–ë–û –≤–∏–∫–æ—Ä–∏—Å—Ç–æ–≤—É–≤–∞—Ç–∏ Route53 (–≤–∞—Ä—ñ–∞–Ω—Ç –Ω–∏–∂—á–µ)

#### –î–ª—è Route53 (—Ä–µ–∫–æ–º–µ–Ω–¥–æ–≤–∞–Ω–æ):

–ó–º—ñ–Ω—ñ—Ç—å –≤ `terraform.tfvars`:
```hcl
create_route53_zone = true
```

–¢–æ–¥—ñ Terraform –∞–≤—Ç–æ–º–∞—Ç–∏—á–Ω–æ —Å—Ç–≤–æ—Ä–∏—Ç—å Route53 zone —ñ DNS –∑–∞–ø–∏—Å–∏.

### –ö—Ä–æ–∫ 6: –°—Ç–≤–æ—Ä–∏—Ç–∏ ACM —Å–µ—Ä—Ç–∏—Ñ—ñ–∫–∞—Ç —á–µ—Ä–µ–∑ Terraform

–ó–∞–ø—É—Å—Ç—ñ—Ç—å GitHub Actions workflow:

1. –ô–¥—ñ—Ç—å –≤ **Actions** ‚Üí **terraform AWS deployment**
2. –ù–∞—Ç–∏—Å–Ω—ñ—Ç—å **Run workflow**
3. –ü–∞—Ä–∞–º–µ—Ç—Ä–∏:
   - **module**: `dns-ssl` (–∞–±–æ `all`)
   - **action**: `plan` (—Å–ø–æ—á–∞—Ç–∫—É –ø–æ–¥–∏–≤–∏—Ç–∏—Å—å –ø–ª–∞–Ω)
4. –ü–µ—Ä–µ–≤—ñ—Ä—Ç–µ –ø–ª–∞–Ω
5. –ó–∞–ø—É—Å—Ç—ñ—Ç—å –∑–Ω–æ–≤—É –∑ **action**: `apply`

Terraform —Å—Ç–≤–æ—Ä–∏—Ç—å:
- ‚úÖ ACM Certificate –¥–ª—è –≤–∞—à–æ–≥–æ –¥–æ–º–µ–Ω—É
- ‚úÖ DNS –≤–∞–ª—ñ–¥–∞—Ü—ñ—é (—è–∫—â–æ Route53)
- ‚úÖ HTTPS listener –Ω–∞ ALB
- ‚úÖ HTTP ‚Üí HTTPS redirect

### –ö—Ä–æ–∫ 7: –î–æ—á–µ–∫–∞—Ç–∏—Å—å –≤–∞–ª—ñ–¥–∞—Ü—ñ—ó —Å–µ—Ä—Ç–∏—Ñ—ñ–∫–∞—Ç—É (5-30 —Ö–≤–∏–ª–∏–Ω)

AWS ACM –≤–∞–ª—ñ–¥—É—î —Å–µ—Ä—Ç–∏—Ñ—ñ–∫–∞—Ç —á–µ—Ä–µ–∑ DNS. –¶–µ –∑–∞–π–º–∞—î 5-30 —Ö–≤–∏–ª–∏–Ω.

**–ü–µ—Ä–µ–≤—ñ—Ä–∏—Ç–∏ —Å—Ç–∞—Ç—É—Å:**

1. AWS Console ‚Üí Certificate Manager ‚Üí Certificates
2. –ó–Ω–∞–π–¥—ñ—Ç—å –≤–∞—à —Å–µ—Ä—Ç–∏—Ñ—ñ–∫–∞—Ç
3. –°—Ç–∞—Ç—É—Å –º–∞—î –±—É—Ç–∏ "Issued" (–∑–µ–ª–µ–Ω–∏–π)

**–Ø–∫—â–æ –≤–∏–∫–æ—Ä–∏—Å—Ç–æ–≤—É—î—Ç–µ Route53**: –≤–∞–ª—ñ–¥–∞—Ü—ñ—è –∞–≤—Ç–æ–º–∞—Ç–∏—á–Ω–∞ ‚úÖ

**–Ø–∫—â–æ –≤–∏–∫–æ—Ä–∏—Å—Ç–æ–≤—É—î—Ç–µ DuckDNS**: –ø–æ—Ç—Ä—ñ–±–Ω–æ –¥–æ–¥–∞—Ç–∏ CNAME –∑–∞–ø–∏—Å –≤—Ä—É—á–Ω—É:
- ACM –ø–æ–∫–∞–∂–µ CNAME name —ñ CNAME value
- –î–æ–¥–∞–π—Ç–µ —ó—Ö –≤ DuckDNS (—è–∫—â–æ –ø—ñ–¥—Ç—Ä–∏–º—É—î CNAME)

### –ö—Ä–æ–∫ 8: –ù–∞–ª–∞—à—Ç—É–≤–∞—Ç–∏ nameservers (—Ç—ñ–ª—å–∫–∏ –¥–ª—è Route53)

–Ø–∫—â–æ `create_route53_zone = true`:

1. –ü—ñ—Å–ª—è `terraform apply` –ø–æ–¥–∏–≤—ñ—Ç—å—Å—è outputs:
   ```bash
   route53_name_servers = [
     "ns-123.awsdns-45.com",
     "ns-678.awsdns-90.org",
     ...
   ]
   ```

2. –°–∫–æ–ø—ñ—é–π—Ç–µ —Ü—ñ nameservers

3. –ô–¥—ñ—Ç—å –¥–æ –≤–∞—à–æ–≥–æ —Ä–µ—î—Å—Ç—Ä–∞—Ç–æ—Ä–∞ –¥–æ–º–µ–Ω—É (DuckDNS/FreeDNS/EU.ORG)

4. –í–∫–∞–∂—ñ—Ç—å —Ü—ñ nameservers —è–∫ DNS —Å–µ—Ä–≤–µ—Ä–∏ –¥–ª—è –≤–∞—à–æ–≥–æ –¥–æ–º–µ–Ω—É

### –ö—Ä–æ–∫ 9: –ü–µ—Ä–µ–≤—ñ—Ä–∏—Ç–∏ HTTPS –ø—ñ–¥–∫–ª—é—á–µ–Ω–Ω—è

–ü—ñ—Å–ª—è –≤–∞–ª—ñ–¥–∞—Ü—ñ—ó —Å–µ—Ä—Ç–∏—Ñ—ñ–∫–∞—Ç—É (5-30 —Ö–≤–∏–ª–∏–Ω):

1. –í—ñ–¥–∫—Ä–∏–π—Ç–µ –±—Ä–∞—É–∑–µ—Ä
2. –ü–µ—Ä–µ–π–¥—ñ—Ç—å –Ω–∞ `https://marafon-app.duckdns.org` (–≤–∞—à –¥–æ–º–µ–Ω)
3. –ü–µ—Ä–µ–≤—ñ—Ä—Ç–µ:
   - ‚úÖ –ó–µ–ª–µ–Ω–∏–π –∑–∞–º–æ–∫ –≤ –∞–¥—Ä–µ—Å–Ω–æ–º—É —Ä—è–¥–∫—É
   - ‚úÖ –°–µ—Ä—Ç–∏—Ñ—ñ–∫–∞—Ç –≤–∞–ª—ñ–¥–Ω–∏–π
   - ‚úÖ HTTP –∞–≤—Ç–æ–º–∞—Ç–∏—á–Ω–æ —Ä–µ–¥—ñ—Ä–µ–∫—Ç–∏—Ç—å –Ω–∞ HTTPS

## Troubleshooting

### –ü–æ–º–∏–ª–∫–∞: Certificate validation timeout

**–ü—Ä–æ–±–ª–µ–º–∞**: ACM –Ω–µ –º–æ–∂–µ –≤–∞–ª—ñ–¥—É–≤–∞—Ç–∏ —Å–µ—Ä—Ç–∏—Ñ—ñ–∫–∞—Ç

**–†—ñ—à–µ–Ω–Ω—è**:
1. –ü–µ—Ä–µ–≤—ñ—Ä—Ç–µ DNS –∑–∞–ø–∏—Å–∏: `nslookup marafon-app.duckdns.org`
2. –ü–µ—Ä–µ–≤—ñ—Ä—Ç–µ CNAME –∑–∞–ø–∏—Å –¥–ª—è –≤–∞–ª—ñ–¥–∞—Ü—ñ—ó –≤ ACM
3. –î–æ—á–µ–∫–∞–π—Ç–µ—Å—å —Ä–æ–∑–ø–æ–≤—Å—é–¥–∂–µ–Ω–Ω—è DNS (–¥–æ 48 –≥–æ–¥–∏–Ω)

### –ü–æ–º–∏–ª–∫–∞: ALB listener –Ω–µ –ø—Ä–∏–π–º–∞—î HTTPS

**–ü—Ä–æ–±–ª–µ–º–∞**: –ü–æ—Ä—Ç 443 –Ω–µ –≤—ñ–¥–∫—Ä–∏—Ç–∏–π

**–†—ñ—à–µ–Ω–Ω—è**:
1. –ü–µ—Ä–µ–≤—ñ—Ä—Ç–µ Security Group: –ø–æ—Ä—Ç 443 –º–∞—î –±—É—Ç–∏ –≤ `alb_ingress_ports`
2. –ü–µ—Ä–µ–≤—ñ—Ä—Ç–µ ALB listener –Ω–∞ –ø–æ—Ä—Ç—É 443
3. –ü–µ—Ä–µ–≤—ñ—Ä—Ç–µ Target Group health checks

### –°–∞–π—Ç –Ω–µ –≤—ñ–¥–∫—Ä–∏–≤–∞—î—Ç—å—Å—è —á–µ—Ä–µ–∑ HTTPS

**–ü—Ä–æ–±–ª–µ–º–∞**: DNS –Ω–µ –≤–∫–∞–∑—É—î –Ω–∞ ALB

**–†—ñ—à–µ–Ω–Ω—è**:
1. –ü–µ—Ä–µ–≤—ñ—Ä—Ç–µ DNS: `nslookup marafon-app.duckdns.org`
2. –ú–∞—î –ø–æ–≤–µ—Ä–Ω—É—Ç–∏ IP ALB (–∞–±–æ CNAME)
3. –ü–µ—Ä–µ–≤—ñ—Ä—Ç–µ Route53 A record –∞–±–æ –Ω–∞–ª–∞—à—Ç—É–≤–∞–Ω–Ω—è DuckDNS

## –ö–æ—Ä–∏—Å–Ω—ñ –∫–æ–º–∞–Ω–¥–∏

```bash
# –ü–µ—Ä–µ–≤—ñ—Ä–∏—Ç–∏ DNS
nslookup marafon-app.duckdns.org

# –ü–µ—Ä–µ–≤—ñ—Ä–∏—Ç–∏ SSL —Å–µ—Ä—Ç–∏—Ñ—ñ–∫–∞—Ç
openssl s_client -connect marafon-app.duckdns.org:443

# –ü–µ—Ä–µ–≤—ñ—Ä–∏—Ç–∏ HTTP ‚Üí HTTPS redirect
curl -I http://marafon-app.duckdns.org
```

## –ê—Ä—Ö—ñ—Ç–µ–∫—Ç—É—Ä–∞ –ø—ñ—Å–ª—è –Ω–∞–ª–∞—à—Ç—É–≤–∞–Ω–Ω—è

```
Internet
    ‚Üì
Route53 (DNS: marafon-app.duckdns.org)
    ‚Üì
ACM Certificate (SSL/TLS)
    ‚Üì
Application Load Balancer (ALB)
  - Listener 80 ‚Üí redirect to 443
  - Listener 443 ‚Üí HTTPS with SSL
    ‚Üì
Target Groups
    ‚Üì
EC2 Instances (dotnet, react, angular)
```

## –ù–∞—Å—Ç—É–ø–Ω—ñ –∫—Ä–æ–∫–∏

- [ ] –î–æ–¥–∞—Ç–∏ www –ø—ñ–¥–¥–æ–º–µ–Ω
- [ ] –ù–∞–ª–∞—à—Ç—É–≤–∞—Ç–∏ –∞–≤—Ç–æ–º–∞—Ç–∏—á–Ω–µ –æ–Ω–æ–≤–ª–µ–Ω–Ω—è —Å–µ—Ä—Ç–∏—Ñ—ñ–∫–∞—Ç—É
- [ ] –î–æ–¥–∞—Ç–∏ monitoring –¥–ª—è SSL expiration
- [ ] –ù–∞–ª–∞—à—Ç—É–≤–∞—Ç–∏ CloudFront CDN (–æ–ø—Ü—ñ–æ–Ω–∞–ª—å–Ω–æ)

## –ü–æ—Å–∏–ª–∞–Ω–Ω—è

- [DuckDNS](https://www.duckdns.org/)
- [AWS ACM Documentation](https://docs.aws.amazon.com/acm/)
- [AWS Route53 Documentation](https://docs.aws.amazon.com/route53/)
- [SSL Setup Guide](ssl-setup-guide.md)
