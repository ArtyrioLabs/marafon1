# SSL Certificate –¥–ª—è DuckDNS —á–µ—Ä–µ–∑ ACM - Workaround

## –ü—Ä–æ–±–ª–µ–º–∞
DuckDNS –Ω–µ –ø—ñ–¥—Ç—Ä–∏–º—É—î CNAME –∑–∞–ø–∏—Å–∏, –Ω–µ–æ–±—Ö—ñ–¥–Ω—ñ –¥–ª—è DNS validation –≤ AWS Certificate Manager.

## –†—ñ—à–µ–Ω–Ω—è: Email Validation

–û—Å–∫—ñ–ª—å–∫–∏ DuckDNS –Ω–µ –ø—ñ–¥—Ç—Ä–∏–º—É—î CNAME, –≤–∏–∫–æ—Ä–∏—Å—Ç–æ–≤—É—î–º–æ **Email validation** –∞–±–æ **HTTP validation**.

### –í–∞—Ä—ñ–∞–Ω—Ç 1: –í–∏–¥–∞–ª–∏—Ç–∏ –ø–æ—Ç–æ—á–Ω–∏–π —Å–µ—Ä—Ç–∏—Ñ—ñ–∫–∞—Ç —ñ —Å—Ç–≤–æ—Ä–∏—Ç–∏ –Ω–æ–≤–∏–π –∑ Email validation

1. **–í–∏–¥–∞–ª—ñ—Ç—å –ø–æ—Ç–æ—á–Ω–∏–π —Å–µ—Ä—Ç–∏—Ñ—ñ–∫–∞—Ç:**
   - AWS Console ‚Üí Certificate Manager
   - –í–∏–±–µ—Ä—ñ—Ç—å —Å–µ—Ä—Ç–∏—Ñ—ñ–∫–∞—Ç –¥–ª—è `secret-nick.duckdns.org`
   - Actions ‚Üí Delete

2. **–°—Ç–≤–æ—Ä—ñ—Ç—å –Ω–æ–≤–∏–π —Å–µ—Ä—Ç–∏—Ñ—ñ–∫–∞—Ç –∑ Email validation:**
   - Request certificate ‚Üí Public certificate
   - Domain name: `secret-nick.duckdns.org`
   - Validation method: **Email validation**
   - Request

3. **–ü—ñ–¥—Ç–≤–µ—Ä–¥—ñ—Ç—å —á–µ—Ä–µ–∑ email:**
   - AWS –Ω–∞–¥—ñ—à–ª–µ –ª–∏—Å—Ç–∏ –Ω–∞ –∞–¥—Ä–µ—Å–∏:
     - administrator@duckdns.org
     - hostmaster@duckdns.org
     - postmaster@duckdns.org
     - webmaster@duckdns.org
     - admin@duckdns.org
   - **–ü–†–û–ë–õ–ï–ú–ê:** –£ –≤–∞—Å –Ω–µ–º–∞—î –¥–æ—Å—Ç—É–ø—É –¥–æ —Ü–∏—Ö email –∞–¥—Ä–µ—Å ‚ùå

### –í–∞—Ä—ñ–∞–Ω—Ç 2: –í–∏–∫–æ—Ä–∏—Å—Ç–∞—Ç–∏ —Å–∞–º–æ–ø—ñ–¥–ø–∏—Å–∞–Ω–∏–π —Å–µ—Ä—Ç–∏—Ñ—ñ–∫–∞—Ç (–Ω–µ —Ä–µ–∫–æ–º–µ–Ω–¥–æ–≤–∞–Ω–æ –¥–ª—è production)

### ‚úÖ –í–∞—Ä—ñ–∞–Ω—Ç 3: –í–∏–∫–æ—Ä–∏—Å—Ç–∞—Ç–∏ Route53 –∑ –ø—ñ–¥–¥–æ–º–µ–Ω–æ–º (–†–ï–ö–û–ú–ï–ù–î–û–í–ê–ù–û)

–ó–∞–º—ñ—Å—Ç—å DuckDNS –≤–∏–∫–æ—Ä–∏—Å—Ç–∞—Ç–∏ Route53 –¥–ª—è —É–ø—Ä–∞–≤–ª—ñ–Ω–Ω—è DNS:

1. **–ó–∞—Ä–µ—î—Å—Ç—Ä—É–≤–∞—Ç–∏ –±–µ–∑–∫–æ—à—Ç–æ–≤–Ω–∏–π –¥–æ–º–µ–Ω –Ω–∞ eu.org –∞–±–æ Freenom**
2. **–ù–∞–ª–∞—à—Ç—É–≤–∞—Ç–∏ nameservers –Ω–∞ Route53**
3. **–í–∏–∫–æ—Ä–∏—Å—Ç–∞—Ç–∏ DNS validation –≤ ACM**

### ‚úÖ –í–∞—Ä—ñ–∞–Ω—Ç 4: HTTP Challenge —á–µ—Ä–µ–∑ Let's Encrypt –Ω–∞ ALB (–ù–ê–ô–ü–†–û–°–¢–Ü–®–ò–ô)

–í–∏–∫–æ—Ä–∏—Å—Ç–∞—Ç–∏ Let's Encrypt –∑ HTTP validation –±–µ–∑–ø–æ—Å–µ—Ä–µ–¥–Ω—å–æ –Ω–∞ ALB.

## –®–≤–∏–¥–∫–µ —Ä—ñ—à–µ–Ω–Ω—è: –Ü–º–ø–æ—Ä—Ç—É–≤–∞—Ç–∏ Let's Encrypt —Å–µ—Ä—Ç–∏—Ñ—ñ–∫–∞—Ç –≤ ACM

### –ö—Ä–æ–∫ 1: –ó–≥–µ–Ω–µ—Ä—É–≤–∞—Ç–∏ —Å–µ—Ä—Ç–∏—Ñ—ñ–∫–∞—Ç —á–µ—Ä–µ–∑ certbot –ª–æ–∫–∞–ª—å–Ω–æ

```bash
# –í—Å—Ç–∞–Ω–æ–≤—ñ—Ç—å certbot –ª–æ–∫–∞–ª—å–Ω–æ (—è–∫—â–æ —â–µ –Ω–µ –≤—Å—Ç–∞–Ω–æ–≤–ª–µ–Ω–æ)
# Windows: –≤–∏–∫–æ—Ä–∏—Å—Ç–∞–π—Ç–µ WSL –∞–±–æ certbot –¥–ª—è Windows

certbot certonly --manual --preferred-challenges http \
  -d secret-nick.duckdns.org \
  --email your-email@example.com \
  --agree-tos
```

### –ö—Ä–æ–∫ 2: Certbot –ø–æ–ø—Ä–æ—Å–∏—Ç—å —Å—Ç–≤–æ—Ä–∏—Ç–∏ —Ñ–∞–π–ª –¥–ª—è validation

Certbot –ø–æ–∫–∞–∂–µ —â–æ—Å—å —Ç–∏–ø—É:
```
Create a file containing just this data:

xxx-yyy-zzz.www-aaa-bbb-ccc

And make it available on your web server at this URL:

http://secret-nick.duckdns.org/.well-known/acme-challenge/xxx-yyy-zzz
```

### –ö—Ä–æ–∫ 3: –ó–∞–≤–∞–Ω—Ç–∞–∂–∏—Ç–∏ —Ñ–∞–π–ª –Ω–∞ EC2 —á–µ—Ä–µ–∑ ALB

–ü–æ—Ç—Ä—ñ–±–Ω–æ –Ω–∞–ª–∞—à—Ç—É–≤–∞—Ç–∏ –∑–∞—Å—Ç–æ—Å—É–Ω–æ–∫, —â–æ–± –≤—ñ–Ω –≤—ñ–¥–¥–∞–≤–∞–≤ —Ü–µ–π —Ñ–∞–π–ª.

---

## üéØ –ù–∞–π–ø—Ä–æ—Å—Ç—ñ—à–µ —Ä—ñ—à–µ–Ω–Ω—è: –í–∏–∫–æ—Ä–∏—Å—Ç–∞—Ç–∏ AWS ALB –∑ –≥–æ—Ç–æ–≤–∏–º —Å–µ—Ä—Ç–∏—Ñ—ñ–∫–∞—Ç–æ–º

–Ø–∫—â–æ —É –≤–∞—Å —î –º–æ–∂–ª–∏–≤—ñ—Å—Ç—å –æ—Ç—Ä–∏–º–∞—Ç–∏ —Å–µ—Ä—Ç–∏—Ñ—ñ–∫–∞—Ç –≤—ñ–¥ Let's Encrypt —á–µ—Ä–µ–∑ —ñ–Ω—à–∏–π —Å–µ—Ä–≤—ñ—Å (–Ω–∞–ø—Ä–∏–∫–ª–∞–¥, Cloudflare), –º–æ–∂–Ω–∞ —ñ–º–ø–æ—Ä—Ç—É–≤–∞—Ç–∏ –π–æ–≥–æ –≤ ACM.

### –ê–ª—å—Ç–µ—Ä–Ω–∞—Ç–∏–≤–∞: Cloudflare Free SSL

1. –î–æ–¥–∞–π—Ç–µ –¥–æ–º–µ–Ω `secret-nick.duckdns.org` –≤ Cloudflare (—è–∫—â–æ –º–æ–∂–ª–∏–≤–æ)
2. Cloudflare –Ω–∞–¥–∞—Å—Ç—å –±–µ–∑–∫–æ—à—Ç–æ–≤–Ω–∏–π SSL
3. –ù–∞–ª–∞—à—Ç—É–π—Ç–µ Cloudflare —è–∫ –ø—Ä–æ–∫—Å—ñ –ø–µ—Ä–µ–¥ ALB

---

## üìù –©–æ —Ä–æ–±–∏—Ç–∏ –∑–∞—Ä–∞–∑?

–ù–∞–π—Ä–µ–∞–ª—ñ—Å—Ç–∏—á–Ω—ñ—à–∏–π –≤–∞—Ä—ñ–∞–Ω—Ç –¥–ª—è –≤–∞—à–æ–≥–æ –≤–∏–ø–∞–¥–∫—É:

### –í–∏–∫–æ—Ä–∏—Å—Ç–∞—Ç–∏ —Å–∞–º–æ–ø—ñ–¥–ø–∏—Å–∞–Ω–∏–π —Å–µ—Ä—Ç–∏—Ñ—ñ–∫–∞—Ç –¥–ª—è —Ç–µ—Å—Ç—É–≤–∞–Ω–Ω—è

1. –ó–≥–µ–Ω–µ—Ä—É–π—Ç–µ —Å–∞–º–æ–ø—ñ–¥–ø–∏—Å–∞–Ω–∏–π —Å–µ—Ä—Ç–∏—Ñ—ñ–∫–∞—Ç:
```bash
openssl req -x509 -nodes -days 365 -newkey rsa:2048 \
  -keyout private.key \
  -out certificate.crt \
  -subj "/CN=secret-nick.duckdns.org"
```

2. –Ü–º–ø–æ—Ä—Ç—É–π—Ç–µ –≤ ACM:
```bash
aws acm import-certificate \
  --certificate fileb://certificate.crt \
  --private-key fileb://private.key \
  --region eu-central-1
```

3. –î–æ–¥–∞–π—Ç–µ HTTPS listener –¥–æ ALB –∑ —Ü–∏–º —Å–µ—Ä—Ç–∏—Ñ—ñ–∫–∞—Ç–æ–º

‚ö†Ô∏è **–ë—Ä–∞—É–∑–µ—Ä –ø–æ–∫–∞–∂–µ –ø–æ–ø–µ—Ä–µ–¥–∂–µ–Ω–Ω—è**, –∞–ª–µ —Ü–µ –±—É–¥–µ –ø—Ä–∞—Ü—é–≤–∞—Ç–∏ –¥–ª—è —Ç–µ—Å—Ç—É–≤–∞–Ω–Ω—è.

---

## üöÄ –ù–∞–π–∫—Ä–∞—â–µ —Ä—ñ—à–µ–Ω–Ω—è –¥–ª—è production: Route53 + –≤–ª–∞—Å–Ω–∏–π –¥–æ–º–µ–Ω

–Ø–∫—â–æ –ø–æ—Ç—Ä—ñ–±–µ–Ω –≤–∞–ª—ñ–¥–Ω–∏–π SSL –±–µ–∑ –ø–æ–ø–µ—Ä–µ–¥–∂–µ–Ω—å, —Ä–µ–∫–æ–º–µ–Ω–¥—É—é:

1. –ó–∞—Ä–µ—î—Å—Ç—Ä—É–≤–∞—Ç–∏ –±–µ–∑–∫–æ—à—Ç–æ–≤–Ω–∏–π –¥–æ–º–µ–Ω –Ω–∞ https://nic.eu.org/ (–Ω–∞–ø—Ä–∏–∫–ª–∞–¥ `marafon.eu.org`)
2. –ù–∞–ª–∞—à—Ç—É–≤–∞—Ç–∏ Route53 nameservers
3. –°—Ç–≤–æ—Ä–∏—Ç–∏ ACM —Å–µ—Ä—Ç–∏—Ñ—ñ–∫–∞—Ç –∑ DNS validation
4. –î–æ–¥–∞—Ç–∏ HTTPS listener –¥–æ ALB

–¶–µ –∑–∞–π–º–µ 1-2 –¥–Ω—ñ –Ω–∞ —Ä–µ—î—Å—Ç—Ä–∞—Ü—ñ—é –¥–æ–º–µ–Ω—É, –∞–ª–µ –¥–∞—Å—Ç—å –ø–æ–≤–Ω–æ—Ü—ñ–Ω–Ω–∏–π SSL.
